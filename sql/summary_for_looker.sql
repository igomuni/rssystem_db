-- 府省庁ごとの事業数と予算合計額を計算する
-- 予算額が0やマイナスのものを除外して、より正確な集計を目指す
SELECT
    組織.府省庁,
    COUNT(DISTINCT 概要.予算事業ID) AS 事業数,
    -- ▼▼▼【修正点1】正しい列名をダブルクォーテーションで囲んで指定▼▼▼
    SUM(予算."計（歳出予算現額合計）") AS 予算合計額
FROM
    "基本情報_組織情報" AS 組織
LEFT JOIN
    "基本情報_事業概要等" AS 概要 ON 組織.予算事業ID = 概要.予算事業ID
LEFT JOIN
    "予算・執行_サマリ" AS 予算 ON 組織.予算事業ID = 予算.予算事業ID
WHERE
    -- ▼▼▼【修正点2】こちらも正しい列名を指定▼▼▼
    予算."計（歳出予算現額合計）" > 0 -- 予算額がプラスのものに限定
GROUP BY
    組織.府省庁
ORDER BY
    予算合計額 DESC;